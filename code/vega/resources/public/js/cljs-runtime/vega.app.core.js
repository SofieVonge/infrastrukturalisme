goog.provide('vega.app.core');
vega.app.core.string__GT_json = (function vega$app$core$string__GT_json(string){
return JSON.parse(string);
});
vega.app.core.json__GT_spec = (function vega$app$core$json__GT_spec(json,keywordize_keys_QMARK_){
return cljs.core.js__GT_clj.cljs$core$IFn$_invoke$arity$variadic(json,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,"keywordize-keys","keywordize-keys",1310784252),keywordize_keys_QMARK_], 0));
});
vega.app.core.spec = vega.app.core.json__GT_spec(vega.app.core.string__GT_json("{\n  \"$schema\": \"https://vega.github.io/schema/vega/v5.json\",\n  \"description\": \"A timeline for Hjelmslev's activities.\",\n  \"width\": 800,\n  \"height\": 200,\n  \"padding\": 10,\n  \"autosize\": \"pad\",\n  \"data\": [\n    {\n      \"name\": \"hjelmslev\",\n      \"url\": \"https://raw.githubusercontent.com/SofieVonge/infrastrukturalisme/master/data/timeline/hjelmslev.json\",\n      \"format\": {\n        \"type\": \"json\",\n        \"parse\": {\n          \"Startdato\": \"date:'%d-%m-%Y'\",\n          \"Slutdato\": \"date:'%d-%m-%Y'\"\n        }\n      },\n      \"transform\": [\n        {\n          \"type\": \"formula\",\n          \"expr\": \"datum.Kategori === 'Rejse' ? 0 : 1\",\n          \"as\": \"sorting\"\n        }\n      ]\n    },\n    {\n      \"name\": \"initValues\",\n      \"format\": {\n        \"type\": \"json\",\n        \"parse\": {\n          \"initRange\": \"date\"\n        }\n      },\n      \"values\": [\n        {\n          \"initRange\": -1262304000000\n        },\n        {\n          \"initRange\": -1136073600000\n        }\n      ],\n      \"transform\": [\n        {\n          \"type\": \"extent\",\n          \"field\": \"initRange\",\n          \"signal\": \"xext\"\n        }\n      ]\n    },\n    {\n      \"name\": \"selected\",\n      \"on\": [\n        {\n          \"trigger\": \"clear\",\n          \"remove\": true\n        },\n        {\n          \"trigger\": \"!shift\",\n          \"remove\": true\n        },\n        {\n          \"trigger\": \"!shift && clicked\",\n          \"insert\": \"clicked\"\n        },\n        {\n          \"trigger\": \"shift && clicked\",\n          \"toggle\": \"clicked\"\n        }\n      ]\n    }\n  ],\n  \"signals\": [\n    {\n      \"name\": \"path\",\n      \"value\": \"M0 -50 H 800 V 200 H0\"\n    },\n    {\n      \"name\": \"clear\",\n      \"value\": true,\n      \"on\": [\n        {\n          \"events\": \"dblclick[!event.item]\",\n          \"update\": \"true\",\n          \"force\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"shift\",\n      \"value\": false,\n      \"on\": [\n        {\n          \"events\": \"@legendSymbol:click, @legendLabel:click\",\n          \"update\": \"event.shiftKey\",\n          \"force\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"clicked\",\n      \"value\": null,\n      \"on\": [\n        {\n          \"events\": \"@legendSymbol:click, @legendLabel:click\",\n          \"update\": \"{value: datum.value}\",\n          \"force\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"down\",\n      \"value\": null,\n      \"on\": [\n        {\n          \"events\": \"mousedown\",\n          \"update\": \"xy()\"\n        }\n      ]\n    },\n    {\n      \"name\": \"xcur\",\n      \"value\": null,\n      \"on\": [\n        {\n          \"events\": \"mousedown\",\n          \"update\": \"slice(xdom)\"\n        }\n      ]\n    },\n    {\n      \"name\": \"delta\",\n      \"value\": [\n        0,\n        0\n      ],\n      \"on\": [\n        {\n          \"events\": [\n            {\n              \"source\": \"window\",\n              \"type\": \"mousemove\",\n              \"filter\": \"!event.shiftKey\",\n              \"consume\": true,\n              \"between\": [\n                {\n                  \"type\": \"mousedown\",\n                  \"filter\": \"!event.shiftKey\"\n                },\n                {\n                  \"source\": \"window\",\n                  \"type\": \"mouseup\"\n                }\n              ]\n            }\n          ],\n          \"update\": \"down ? [down[0]-x(), y()-down[1]] : [0,0]\"\n        }\n      ]\n    },\n    {\n      \"name\": \"xdom\",\n      \"update\": \"slice(xext)\",\n      \"on\": [\n        {\n          \"events\": \"dblclick\",\n          \"update\": \"slice(xext)\"\n        },\n        {\n          \"events\": {\n            \"signal\": \"delta\"\n          },\n          \"update\": \"[xcur[0] + span(xcur) * delta[0] / width, xcur[1] + span(xcur) * delta[0] / width]\"\n        }\n      ]\n    }\n  ],\n  \"scales\": [\n    {\n      \"name\": \"yscale\",\n      \"type\": \"band\",\n      \"range\": \"height\",\n      \"domain\": {\n        \"data\": \"hjelmslev\",\n        \"field\": \"Kategori\",\n        \"sort\": {\n          \"op\": \"min\",\n          \"field\": \"sorting\"\n        }\n      }\n    },\n    {\n      \"name\": \"xscale\",\n      \"type\": \"time\",\n      \"padding\": 0.5,\n      \"domain\": {\n        \"signal\": \"xdom\"\n      },\n      \"range\": \"width\"\n    },\n    {\n      \"name\": \"color\",\n      \"type\": \"ordinal\",\n      \"range\": {\n        \"scheme\": \"category20\"\n      },\n      \"domain\": {\n        \"data\": \"hjelmslev\",\n        \"field\": \"Kategori\"\n      }\n    }\n  ],\n  \"axes\": [\n    {\n      \"orient\": \"bottom\",\n      \"scale\": \"xscale\",\n      \"format\": \"%m.%Y\",\n      \"labelAngle\": -40,\n      \"labelPadding\": 9\n    },\n    {\n      \"orient\": \"left\",\n      \"scale\": \"yscale\",\n      \"grid\": true,\n      \"encode\": {\n        \"labels\": {\n          \"enter\": {\n            \"fill\": {\n              \"signal\": \"scale('color', datum.value)\"\n            }\n          }\n        }\n      }\n    }\n  ],\n  \"legends\": [\n    {\n      \"stroke\": \"color\",\n      \"symbolType\": \"stroke\",\n      \"direction\": \"horizontal\",\n      \"orient\": \"top\",\n      \"offset\": 80,\n      \"encode\": {\n        \"symbols\": {\n          \"name\": \"legendSymbol\",\n          \"interactive\": true,\n          \"update\": {\n            \"opacity\": [\n              {\n                \"test\": \"!length(data('selected')) || indata('selected', 'value', datum.value)\",\n                \"value\": 1\n              },\n              {\n                \"value\": 0.25\n              }\n            ]\n          }\n        },\n        \"labels\": {\n          \"name\": \"legendLabel\",\n          \"interactive\": true,\n          \"update\": {\n            \"opacity\": [\n              {\n                \"test\": \"!length(data('selected')) || indata('selected', 'value', datum.value)\",\n                \"value\": 1\n              },\n              {\n                \"value\": 0.25\n              }\n            ]\n          }\n        }\n      }\n    }\n  ],\n  \"marks\": [\n    {\n      \"type\": \"path\",\n      \"encode\": {\n        \"update\": {\n          \"fill\": {\n            \"value\": \"purple\"\n          },\n          \"path\": {\n            \"signal\": \"null\"\n          }\n        }\n      }\n    },\n    {\n      \"type\": \"text\",\n      \"from\": {\n        \"data\": \"hjelmslev\"\n      },\n      \"zindex\": 99,\n      \"clip\": {\n        \"path\": \"M0 -50 H 800 V 200 H0\"\n      },\n      \"encode\": {\n        \"update\": {\n          \"x\": {\n            \"scale\": \"xscale\",\n            \"field\": \"Startdato\",\n            \"offset\": 5.5\n          },\n          \"y\": {\n            \"field\": \"Kategori\",\n            \"scale\": \"yscale\",\n            \"offset\": 3\n          },\n          \"angle\": {\n            \"value\": -60\n          },\n          \"text\": {\n            \"field\": \"Event\"\n          },\n          \"limit\": {\n            \"value\": 50\n          },\n          \"tooltip\": [\n            {\n              \"test\": \"(!length(data('selected')) || indata('selected', 'value', datum.Kategori))\",\n              \"signal\": \"datum.Tooltip\"\n            }\n          ],\n          \"opacity\": [\n            {\n              \"test\": \"(!length(data('selected')) || indata('selected', 'value', datum.Kategori))\",\n              \"value\": 1\n            },\n            {\n              \"value\": 0\n            }\n          ]\n        }\n      }\n    },\n    {\n      \"type\": \"symbol\",\n      \"from\": {\n        \"data\": \"hjelmslev\"\n      },\n      \"clip\": true,\n      \"zindex\": 80,\n      \"encode\": {\n        \"update\": {\n          \"x\": {\n            \"scale\": \"xscale\",\n            \"field\": \"Startdato\"\n          },\n          \"y\": {\n            \"scale\": \"yscale\",\n            \"field\": \"Kategori\",\n            \"offset\": 6\n          },\n          \"fill\": {\n            \"scale\": \"color\",\n            \"field\": \"Kategori\"\n          },\n          \"tooltip\": [\n            {\n              \"test\": \"(!length(data('selected')) || indata('selected', 'value', datum.Kategori))\",\n              \"signal\": \"'Land: ' + datum.Land\"\n            }\n          ],\n          \"opacity\": [\n            {\n              \"test\": \"(!length(data('selected')) || indata('selected', 'value', datum.Kategori))\",\n              \"value\": 1\n            },\n            {\n              \"value\": 0\n            }\n          ]\n        }\n      }\n    },\n    {\n      \"type\": \"rect\",\n      \"from\": {\n        \"data\": \"hjelmslev\"\n      },\n      \"zindex\": 1,\n      \"clip\": true,\n      \"encode\": {\n        \"enter\": {\n          \"y\": {\n            \"scale\": \"yscale\",\n            \"field\": \"Kategori\",\n            \"offset\": 4\n          },\n          \"height\": {\n            \"value\": 4\n          },\n          \"fill\": {\n            \"scale\": \"color\",\n            \"field\": \"Kategori\"\n          }\n        },\n        \"update\": {\n          \"x\": {\n            \"scale\": \"xscale\",\n            \"field\": \"Startdato\"\n          },\n          \"x2\": {\n            \"scale\": \"xscale\",\n            \"field\": \"Slutdato\"\n          },\n          \"tooltip\": [\n            {\n              \"test\": \"(!length(data('selected')) || indata('selected', 'value', datum.Kategori))\",\n              \"signal\": \"'Land: ' + datum.Land\"\n            }\n          ],\n          \"opacity\": [\n            {\n              \"test\": \"(!length(data('selected')) || indata('selected', 'value', datum.Kategori))\",\n              \"value\": 1\n            },\n            {\n              \"value\": 0\n            }\n          ]\n        }\n      }\n    }\n  ],\n  \"config\": {}\n}"),true);
vega.app.core.year_QMARK_ = cljs.spec.alpha.and_spec_impl(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol("cljs.core","number?","cljs.core/number?",-811857295,null),cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core",">","cljs.core/>",2020535938,null),new cljs.core.Symbol(null,"%","%",-950237169,null),(1880))),cljs.core.list(new cljs.core.Symbol("cljs.core","fn","cljs.core/fn",-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"%","%",-950237169,null)], null),cljs.core.list(new cljs.core.Symbol("cljs.core","<","cljs.core/<",1677496129,null),new cljs.core.Symbol(null,"%","%",-950237169,null),(2020)))], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.number_QMARK_,(function (p1__43854_SHARP_){
return (p1__43854_SHARP_ > (1880));
}),(function (p1__43855_SHARP_){
return (p1__43855_SHARP_ < (2020));
})], null),null);
vega.app.core.valid_colors = new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 14, ["tableau10",null,"pastel1",null,"set1",null,"category20",null,"paired",null,"tableau20",null,"set2",null,"category20c",null,"pastel2",null,"set3",null,"dark2",null,"category20b",null,"category10",null,"accent",null], null), null);
vega.app.core.change_range = (function vega$app$core$change_range(vega_spec,start_year,end_year){
if(((cljs.spec.alpha.valid_QMARK_.cljs$core$IFn$_invoke$arity$2(vega.app.core.year_QMARK_,start_year)) && (cljs.spec.alpha.valid_QMARK_.cljs$core$IFn$_invoke$arity$2(vega.app.core.year_QMARK_,end_year)))){
return cljs.core.assoc_in(vega_spec,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"data","data",-232669377),(1),new cljs.core.Keyword(null,"values","values",372645556)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"initRange","initRange",537969104),[cljs.core.str.cljs$core$IFn$_invoke$arity$1(start_year),"-01-01"].join('')], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"initRange","initRange",537969104),[cljs.core.str.cljs$core$IFn$_invoke$arity$1(end_year),"-01-01"].join('')], null)], null));
} else {
return null;
}
});
vega.app.core.filter_data = (function vega$app$core$filter_data(vega_spec,column_name,value){
return cljs.core.assoc_in(vega_spec,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"data","data",-232669377),(0),new cljs.core.Keyword(null,"transform","transform",1381301764),(1)], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"type","type",1174270348),"filter",new cljs.core.Keyword(null,"expr","expr",745722291),["datum.",cljs.core.str.cljs$core$IFn$_invoke$arity$1(column_name)," === '",cljs.core.str.cljs$core$IFn$_invoke$arity$1(value),"'"].join('')], null));
});
vega.app.core.change_color = (function vega$app$core$change_color(vega_spec,scheme){
if(cljs.core.contains_QMARK_(vega.app.core.valid_colors,scheme)){
return cljs.core.assoc_in(vega_spec,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"scales","scales",-1197224722),(2),new cljs.core.Keyword(null,"range","range",1639692286)], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"scheme","scheme",90199613),scheme], null));
} else {
return null;
}
});
vega.app.core.new_spec = vega.app.core.change_color(vega.app.core.spec,"set1");
vega.app.core.app = (function vega$app$core$app(){
console.log("Spec: ",vega.app.core.new_spec);

return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [oz.core.vega,vega.app.core.new_spec,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"mode","mode",654403691),"vega"], null)], null);
});
vega.app.core.root = document.getElementById("app");
vega.app.core.render = (function vega$app$core$render(){
return reagent.dom.render.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [vega.app.core.app], null),vega.app.core.root);
});
vega.app.core.init = (function vega$app$core$init(){
return vega.app.core.render();
});

//# sourceMappingURL=vega.app.core.js.map
